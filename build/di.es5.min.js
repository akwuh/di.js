!function(n,e){if("function"==typeof define&&define.amd)define("di",["exports","lodash"],e);else if("undefined"!=typeof exports)e(exports,require("lodash"));else{var r={exports:{}};e(r.exports,n.lodash),n.di=r.exports}}(this,function(n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function n(n,e){var r=[],t=!0,i=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(t=(u=s.next()).done)&&(r.push(u.value),!e||r.length!==e);t=!0);}catch(n){i=!0,o=n}finally{try{!t&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return n(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),t=e.extend,i=e.defaults,o=e.uniqueId,u=e.values,s=e.isArray,c=e.isObject,a=e.isFunction,f=e.forEach,d=e.map,l=function(n,e){return n&&n.then?n.then(e):e(n)},v=function(n,e){var r=n.some(function(n){return!(!n||!n.then)});return r?Promise.all(n).then(e):e(n)},p=function(n,e){return n&&n.catch&&n.catch(e),n},h=function(n){var e={},r=function(n){n.keys().forEach(function(r){var t=r.match(/\/([^\/]+)$/)[1];e[t]||(e[t]=function(){return n(r)})})};return n.forEach(r),function(n){n.match(/\.js$/)||(n+=".js");var r=e[n],t=void 0;return r?(t=r(),"function"!=typeof t||t.name?t:new Promise(function(n){t(n)})):void 0}},m=function(n){return function(e){return n[e]}},y=function(n){var e={};return function(r){var t=n.slice();if(e[r])return e[r];var i=function n(){if(t.length){var i=t.shift();return l(i(r),function(t){return t?e[r]=t:n()})}};return e[r]=i()}},g=function(n){var e=n?n.match(/^([^.]+)(\.(.+))?$/):null;if(!e)throw Error("Unknown module format: "+JSON.stringify(n));return{bundleName:e[1],factory:e[3]}},w=function(n,e){var r={id:n};if("string"==typeof e)t(r,g(e));else if(s(e))1===e.length?(r.id=o("di"),t(r,e[0])):t(r,g(e[0]),{dependencies:e[1]});else{if(!c(e))throw Error("Unknown type of dependency definition");t(r,g(n),{dependencies:e})}return i(r,{factory:"factory",dependencies:{}})},b=function n(e,r){f(e.dependencies,function(t,i){if("object"!=typeof t||s(t)||(t=[i,t]),s(t)){var u=w(o(e.id+"/"+i),t);r[u.id]=u,e.dependencies[i]=u.id,n(u,r)}})},S=function(n){var e={};return f(n,function(n,r){e[r]=w(r,n)}),f(e,function(n){b(n,e)}),e},I=function(n,e){var r=n.Module,t=n.factory;return r.__esModule===!0&&(r=u(r)[0]),r[t]?r[t](e):new r(e)},E=function(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=n.resolvers,i=void 0===e?[]:e,u=n.dependencies,s=void 0===u?{}:u,c=S(s),p=y(i),h=function(n){return n.Module?n.Module:l(p(n.bundleName),function(e){return e?(n.Module=e,e):Promise.reject(Error('Cannot find bundle with name "'+n.bundleName+'"'))})},m=function(n){if("string"==typeof n)return c[n]?c[n]:c[n]=w(n,{});throw console.log("UNKNOWN MODULE",n),Error("Unknown module")},g=function(n,e){var t=m(n),i=function(){var n=[E(t,e),t.instance?null:h(t)];return v(n,function(n){var i=r(n,1),o=i[0],u=function(){return t.instance?t.instance:I(t,o)};return l(u(),function(n){var r=!e.diSessionId||t.diSessionId!==e.diSessionId;return t.diSessionId=e.diSessionId,a(n.updateDependencies)&&r?l(n.updateDependencies(o),function(){return n}):n})})};return t._progress?t._progress:(t._progress=l(i(),function(n){return t.instance=n,n}),l(t._progress,function(n){return t._progress=null,n}))},b=function(n,e){var r=t({},e);if(n){var i=d(n,function(n,t){return l(g(n,e),function(n){return r[t]=n})});return v(i,function(){return r})}return r},E=function(n,e){return b(n.dependencies,e)},_=function(n){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=void 0;return r="string"==typeof n?g(n,e):b(n,e)};return _.session=function(){var n=o("di");return{load:function(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.diSessionId=n,_(e,r)},close:function(){f(c,function(e){var r=e.instance;!e.isPersistent&&e.diSessionId&&e.diSessionId!==n&&r&&(r.trigger&&r.trigger("di:destroy"),a(r.destroy)&&r.destroy(),e.instance=null)})}}},_.put=function(n,e){var r=m(n);return r.instance=e,void(r.isPersistent=!0)},_};n.createContainer=E,n.webpackResolver=h,n.staticResolver=m,n.arrayResolver=y,n.then=l,n.all=v,n.qCatch=p,n.normalizeDefinitionDependencies=b,n.parseStringDefinition=g,n.normalizeDefinitions=S,n.normalizeDefinition=w,n.factory=I});